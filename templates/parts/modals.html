<div class="modal fade" id="logModal" tabindex="-1"> <div class="modal-dialog modal-dialog-scrollable"> <div class="modal-content"> <div class="modal-header"> <h5 class="modal-title">üìÑ Trade Logs</h5> <button type="button" class="btn-close" data-bs-dismiss="modal"></button> </div> <div class="modal-body bg-light" id="logModalBody" style="font-family: monospace; font-size: 0.85rem;"> </div> </div> </div> </div>
<div class="modal fade" id="editTradeModal" tabindex="-1"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"><h5 class="modal-title">‚úèÔ∏è Edit Trade Protection</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div> <div class="modal-body"> <input type="hidden" id="edit_trade_id"> <label class="pos-grid-label">New Entry Price</label><input type="number" step="0.05" id="edit_entry" class="form-control mb-3 text-primary fw-bold"> <label class="pos-grid-label">New Stop Loss</label><input type="number" step="0.05" id="edit_sl" class="form-control mb-3 text-danger fw-bold"> <label class="pos-grid-label">Trailing SL (Points)</label> <div class="input-group mb-3"> <input type="number" step="0.05" id="edit_trail" class="form-control text-info fw-bold" placeholder="0 to disable"> <select id="edit_trail_mode" class="form-select fw-bold" style="max-width: 130px;"> <option value="0">Unlimited</option> <option value="1">Up-to Entry</option> <option value="2">Up-to T1</option> <option value="3">Up-to T2</option> <option value="4">Up-to T3</option> </select> </div> <label class="pos-grid-label">Exit Multiplier (Auto-Calc Targets)</label> <input type="number" id="edit_exit_mult" class="form-control mb-3 fw-bold text-center border-info" value="1" min="1" max="10"> <label class="pos-grid-label">New Targets (Price | Active | Exit Lots)</label> <div class="input-group mb-2"> <span class="input-group-text text-success">T1</span> <input type="number" step="0.05" id="edit_t1" class="form-control"> <div class="input-group-text"> <input class="form-check-input mt-0" type="checkbox" id="check_t1" checked> </div> <input type="number" id="lot_t1" class="form-control" placeholder="Lots" style="max-width: 70px;"> <div class="input-group-text" title="Exit All"> <input class="form-check-input mt-0" type="checkbox" id="full_t1"> <span style="font-size:0.7rem; margin-left:3px;">Full</span> </div> </div> <div class="input-group mb-2"> <span class="input-group-text text-success">T2</span> <input type="number" step="0.05" id="edit_t2" class="form-control"> <div class="input-group-text"> <input class="form-check-input mt-0" type="checkbox" id="check_t2" checked> </div> <input type="number" id="lot_t2" class="form-control" placeholder="Lots" style="max-width: 70px;"> <div class="input-group-text" title="Exit All"> <input class="form-check-input mt-0" type="checkbox" id="full_t2"> <span style="font-size:0.7rem; margin-left:3px;">Full</span> </div> </div> <div class="input-group mb-2"> <span class="input-group-text text-success">T3</span> <input type="number" step="0.05" id="edit_t3" class="form-control"> <div class="input-group-text"> <input class="form-check-input mt-0" type="checkbox" id="check_t3" checked> </div> <input type="number" id="lot_t3" class="form-control" placeholder="Lots" style="max-width: 70px;"> <div class="input-group-text" title="Exit All"> <input class="form-check-input mt-0" type="checkbox" id="full_t3"> <span style="font-size:0.7rem; margin-left:3px;">Full</span> </div> </div> <hr> <h6 class="text-secondary fw-bold">Manage Position (Lots)</h6> <div class="row g-2 mb-2"> <div class="col-6"> <label class="pos-grid-label text-success">Add Lots (Avg)</label> <div class="input-group input-group-sm"> <input type="number" id="man_add_lots" class="form-control fw-bold" placeholder="Qty"> <button class="btn btn-success" onclick="managePos('ADD')">Buy</button> </div> </div> <div class="col-6"> <label class="pos-grid-label text-warning">Exit Lots (Part)</label> <div class="input-group input-group-sm"> <input type="number" id="man_exit_lots" class="form-control fw-bold" placeholder="Qty"> <button class="btn btn-warning" onclick="managePos('EXIT')">Sell</button> </div> </div> </div> </div> <div class="modal-footer"><button type="button" class="btn btn-primary w-100" onclick="saveTradeUpdate()">üíæ Update Protection</button></div> </div> </div> </div>
<div class="modal fade" id="settingsModal" tabindex="-1"> <div class="modal-dialog modal-lg"> <div class="modal-content"> <div class="modal-header"><h5 class="modal-title">‚öôÔ∏è Global Settings</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div> <div class="modal-body"> 
    <ul class="nav nav-tabs mb-3" id="settingTabs" role="tablist"> 
        <li class="nav-item"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#tab-general">General</button></li> 
        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-paper">Paper</button></li> 
        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-live">Live</button></li> 
        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-sim">Simulator</button></li> 
        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-telegram">Telegram</button></li> 
    </ul> 
    <div class="tab-content" id="settingTabsContent"> 
        <div class="tab-pane fade show active" id="tab-general"> <h6 class="mb-2">Active Exchanges (For Search)</h6> <div class="d-flex flex-wrap gap-2 mb-3"> <div class="form-check"><input class="form-check-input" type="checkbox" name="exch_select" value="NSE" id="exch_NSE"><label class="form-check-label" for="exch_NSE">NSE</label></div> <div class="form-check"><input class="form-check-input" type="checkbox" name="exch_select" value="NFO" id="exch_NFO"><label class="form-check-label" for="exch_NFO">NFO</label></div> <div class="form-check"><input class="form-check-input" type="checkbox" name="exch_select" value="MCX" id="exch_MCX"><label class="form-check-label" for="exch_MCX">MCX</label></div> <div class="form-check"><input class="form-check-input" type="checkbox" name="exch_select" value="CDS" id="exch_CDS"><label class="form-check-label" for="exch_CDS">CDS</label></div> <div class="form-check"><input class="form-check-input" type="checkbox" name="exch_select" value="BSE" id="exch_BSE"><label class="form-check-label" for="exch_BSE">BSE</label></div> <div class="form-check"><input class="form-check-input" type="checkbox" name="exch_select" value="BFO" id="exch_BFO"><label class="form-check-label" for="exch_BFO">BFO</label></div> </div> </div> 
        
        <div class="tab-pane fade" id="tab-paper"> <h6 class="mb-2 text-warning">Paper Trade Config</h6> 
            <div class="row g-2 mb-2"> <div class="col-6"> <label class="pos-grid-label">Default Order Type</label> <select id="paper_order_type" class="form-select"> <option value="MARKET">MARKET</option> <option value="LIMIT">LIMIT</option> </select> </div> <div class="col-6"> <label class="pos-grid-label">Trail Limit Default</label> <select id="paper_trail_limit" class="form-select"> <option value="0">Unlimited</option> <option value="1">Up-to Entry</option> <option value="2">Up-to T1</option> <option value="3">Up-to T2</option> <option value="4">Up-to T3</option> </select> </div> </div>
            <div class="row g-2 mb-2"> <div class="col-6"><label class="pos-grid-label">Default Trailing (Pts)</label><input type="number" step="0.5" id="paper_def_trail" class="form-control" placeholder="0"></div> <div class="col-6"><label class="pos-grid-label">Exit Multiplier</label><input type="number" id="paper_exit_mult" class="form-control" value="1" min="1" max="10"></div> </div>
            <label class="pos-grid-label">Quantity Multiplier</label><input type="number" id="paper_qty_mult" class="form-control mb-2" value="1" min="1"> 
            <label class="pos-grid-label">Target Config (Ratio | Active | Lots | Full)</label> 
            <div class="input-group mb-1"> <span class="input-group-text">T1</span><input type="number" step="0.1" id="paper_r1" class="form-control"> <div class="input-group-text px-1"><input class="form-check-input mt-0" type="checkbox" id="paper_a1"></div> <input type="number" id="paper_l1" class="form-control" placeholder="Lots"> <div class="input-group-text px-1" title="Full"><input class="form-check-input mt-0" type="checkbox" id="paper_f1"></div> </div> 
            <div class="input-group mb-1"> <span class="input-group-text">T2</span><input type="number" step="0.1" id="paper_r2" class="form-control"> <div class="input-group-text px-1"><input class="form-check-input mt-0" type="checkbox" id="paper_a2"></div> <input type="number" id="paper_l2" class="form-control" placeholder="Lots"> <div class="input-group-text px-1" title="Full"><input class="form-check-input mt-0" type="checkbox" id="paper_f2"></div> </div> 
            <div class="input-group mb-2"> <span class="input-group-text">T3</span><input type="number" step="0.1" id="paper_r3" class="form-control"> <div class="input-group-text px-1"><input class="form-check-input mt-0" type="checkbox" id="paper_a3"></div> <input type="number" id="paper_l3" class="form-control" placeholder="Lots"> <div class="input-group-text px-1" title="Full"><input class="form-check-input mt-0" type="checkbox" id="paper_f3"></div> </div> 
            <label class="pos-grid-label">Bulk Update (SYMBOL|SL)</label> <textarea id="paper_bulk_sl" class="form-control mb-2" rows="2" placeholder="ACC|8&#10;RELIANCE|20"></textarea> <button class="btn btn-sm btn-outline-secondary mb-3 w-100" onclick="applyBulkSL('PAPER')">Apply Bulk SL</button> <div class="input-group mb-2"><input type="text" id="paper_set_sym" class="form-control" placeholder="Symbol"><input type="number" id="paper_set_sl" class="form-control" placeholder="SL Pts"><button class="btn btn-primary" onclick="saveSymSL('PAPER')">Add</button></div> <div class="table-responsive mb-3" style="max-height: 150px; overflow-y: auto;"> <table class="table table-bordered table-sm mt-2 sl-table"><thead class="table-light"><tr><th>Symbol</th><th>SL</th><th>Action</th></tr></thead><tbody id="paper_sl_table_body"></tbody></table> </div> 
        </div> 
        <div class="tab-pane fade" id="tab-live"> <h6 class="mb-2 text-danger">Live Trade Config</h6> 
            <div class="row g-2 mb-2"> <div class="col-6"> <label class="pos-grid-label">Default Order Type</label> <select id="live_order_type" class="form-select"> <option value="MARKET">MARKET</option> <option value="LIMIT">LIMIT</option> </select> </div> <div class="col-6"> <label class="pos-grid-label">Trail Limit Default</label> <select id="live_trail_limit" class="form-select"> <option value="0">Unlimited</option> <option value="1">Up-to Entry</option> <option value="2">Up-to T1</option> <option value="3">Up-to T2</option> <option value="4">Up-to T3</option> </select> </div> </div>
            <div class="row g-2 mb-2"> <div class="col-6"><label class="pos-grid-label">Default Trailing (Pts)</label><input type="number" step="0.5" id="live_def_trail" class="form-control" placeholder="0"></div> <div class="col-6"><label class="pos-grid-label">Exit Multiplier</label><input type="number" id="live_exit_mult" class="form-control" value="1" min="1" max="10"></div> </div>
            <label class="pos-grid-label">Quantity Multiplier</label><input type="number" id="live_qty_mult" class="form-control mb-2" value="1" min="1"> 
            <label class="pos-grid-label">Target Config (Ratio | Active | Lots | Full)</label> 
            <div class="input-group mb-1"> <span class="input-group-text">T1</span><input type="number" step="0.1" id="live_r1" class="form-control"> <div class="input-group-text px-1"><input class="form-check-input mt-0" type="checkbox" id="live_a1"></div> <input type="number" id="live_l1" class="form-control" placeholder="Lots"> <div class="input-group-text px-1" title="Full"><input class="form-check-input mt-0" type="checkbox" id="live_f1"></div> </div> 
            <div class="input-group mb-1"> <span class="input-group-text">T2</span><input type="number" step="0.1" id="live_r2" class="form-control"> <div class="input-group-text px-1"><input class="form-check-input mt-0" type="checkbox" id="live_a2"></div> <input type="number" id="live_l2" class="form-control" placeholder="Lots"> <div class="input-group-text px-1" title="Full"><input class="form-check-input mt-0" type="checkbox" id="live_f2"></div> </div> 
            <div class="input-group mb-2"> <span class="input-group-text">T3</span><input type="number" step="0.1" id="live_r3" class="form-control"> <div class="input-group-text px-1"><input class="form-check-input mt-0" type="checkbox" id="live_a3"></div> <input type="number" id="live_l3" class="form-control" placeholder="Lots"> <div class="input-group-text px-1" title="Full"><input class="form-check-input mt-0" type="checkbox" id="live_f3"></div> </div> 
            <label class="pos-grid-label">Bulk Update (SYMBOL|SL)</label> <textarea id="live_bulk_sl" class="form-control mb-2" rows="2" placeholder="ACC|8&#10;RELIANCE|20"></textarea> <button class="btn btn-sm btn-outline-secondary mb-3 w-100" onclick="applyBulkSL('LIVE')">Apply Bulk SL</button> <div class="input-group mb-2"><input type="text" id="live_set_sym" class="form-control" placeholder="Symbol"><input type="number" id="live_set_sl" class="form-control" placeholder="SL Pts"><button class="btn btn-primary" onclick="saveSymSL('LIVE')">Add</button></div> <div class="table-responsive mb-3" style="max-height: 150px; overflow-y: auto;"> <table class="table table-bordered table-sm mt-2 sl-table"><thead class="table-light"><tr><th>Symbol</th><th>SL</th><th>Action</th></tr></thead><tbody id="live_sl_table_body"></tbody></table> </div> 
        </div> 
        <div class="tab-pane fade" id="tab-sim"> <h6 class="mb-2 text-info">Simulator Config</h6> 
             <div class="row g-2 mb-2"> <div class="col-6"> <label class="pos-grid-label">Default Order Type</label> <select id="sim_order_type" class="form-select"> <option value="MARKET">MARKET</option> <option value="LIMIT">LIMIT</option> </select> </div> <div class="col-6"> <label class="pos-grid-label">Trail Limit Default</label> <select id="sim_trail_limit" class="form-select"> <option value="0">Unlimited</option> <option value="1">Up-to Entry</option> <option value="2">Up-to T1</option> <option value="3">Up-to T2</option> <option value="4">Up-to T3</option> </select> </div> </div>
            <div class="row g-2 mb-2"> <div class="col-6"><label class="pos-grid-label">Default Trailing (Pts)</label><input type="number" step="0.5" id="sim_def_trail" class="form-control" placeholder="0"></div> <div class="col-6"><label class="pos-grid-label">Exit Multiplier</label><input type="number" id="sim_exit_mult" class="form-control" value="1" min="1" max="10"></div> </div>
            <label class="pos-grid-label">Quantity Multiplier</label><input type="number" id="sim_qty_mult" class="form-control mb-2" value="1" min="1"> 
            <label class="pos-grid-label">Target Config (Ratio | Active | Lots | Full)</label> 
            <div class="input-group mb-1"> <span class="input-group-text">T1</span><input type="number" step="0.1" id="sim_r1" class="form-control"> <div class="input-group-text px-1"><input class="form-check-input mt-0" type="checkbox" id="sim_a1"></div> <input type="number" id="sim_l1" class="form-control" placeholder="Lots"> <div class="input-group-text px-1" title="Full"><input class="form-check-input mt-0" type="checkbox" id="sim_f1"></div> </div> 
            <div class="input-group mb-1"> <span class="input-group-text">T2</span><input type="number" step="0.1" id="sim_r2" class="form-control"> <div class="input-group-text px-1"><input class="form-check-input mt-0" type="checkbox" id="sim_a2"></div> <input type="number" id="sim_l2" class="form-control" placeholder="Lots"> <div class="input-group-text px-1" title="Full"><input class="form-check-input mt-0" type="checkbox" id="sim_f2"></div> </div> 
            <div class="input-group mb-2"> <span class="input-group-text">T3</span><input type="number" step="0.1" id="sim_r3" class="form-control"> <div class="input-group-text px-1"><input class="form-check-input mt-0" type="checkbox" id="sim_a3"></div> <input type="number" id="sim_l3" class="form-control" placeholder="Lots"> <div class="input-group-text px-1" title="Full"><input class="form-check-input mt-0" type="checkbox" id="sim_f3"></div> </div> 
            <label class="pos-grid-label">Bulk Update (SYMBOL|SL)</label> <textarea id="sim_bulk_sl" class="form-control mb-2" rows="2" placeholder="ACC|8&#10;RELIANCE|20"></textarea> <button class="btn btn-sm btn-outline-secondary mb-3 w-100" onclick="applyBulkSL('SIMULATOR')">Apply Bulk SL</button> <div class="input-group mb-2"><input type="text" id="sim_set_sym" class="form-control" placeholder="Symbol"><input type="number" id="sim_set_sl" class="form-control" placeholder="SL Pts"><button class="btn btn-primary" onclick="saveSymSL('SIMULATOR')">Add</button></div> <div class="table-responsive mb-3" style="max-height: 150px; overflow-y: auto;"> <table class="table table-bordered table-sm mt-2 sl-table"><thead class="table-light"><tr><th>Symbol</th><th>SL</th><th>Action</th></tr></thead><tbody id="sim_sl_table_body"></tbody></table> </div> 
        </div>

        <div class="tab-pane fade" id="tab-telegram">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h6 class="m-0 text-primary">üîµ Telegram Bot Config</h6>
                <div class="form-check form-switch">
                    <input class="form-check-input" type="checkbox" id="tg_enabled">
                    <label class="form-check-label fw-bold" for="tg_enabled">Enable</label>
                </div>
            </div>
            
            <div class="input-group mb-2">
                <span class="input-group-text"><i class="fas fa-robot"></i></span>
                <input type="text" id="tg_token" class="form-control" placeholder="Bot Token (e.g., 12345:AAH...)">
            </div>
            <div class="input-group mb-4">
                <span class="input-group-text"><i class="fas fa-paper-plane"></i></span>
                <input type="text" id="tg_chat" class="form-control" placeholder="Channel/Chat ID (e.g., -100123...)">
            </div>

            <h6 class="mb-2">üîî Notification Events & Templates</h6>
            <div class="accordion" id="tgAccordion">
                <div class="accordion-item">
                    <h2 class="accordion-header"><button class="accordion-button collapsed py-2" type="button" data-bs-toggle="collapse" data-bs-target="#tg_c1">1. Trade Added</button></h2>
                    <div id="tg_c1" class="accordion-collapse collapse" data-bs-parent="#tgAccordion">
                        <div class="accordion-body p-2">
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" id="tg_evt_TRADE_ADDED">
                                <label class="form-check-label small">Send Alert</label>
                            </div>
                            <textarea id="tg_tmpl_TRADE_ADDED" class="form-control" rows="3" style="font-size:0.8rem;"></textarea>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header"><button class="accordion-button collapsed py-2" type="button" data-bs-toggle="collapse" data-bs-target="#tg_c2">1.1 Trade Update (SL/Target)</button></h2>
                    <div id="tg_c2" class="accordion-collapse collapse" data-bs-parent="#tgAccordion">
                        <div class="accordion-body p-2">
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" id="tg_evt_TRADE_UPDATE">
                                <label class="form-check-label small">Send Alert</label>
                            </div>
                            <textarea id="tg_tmpl_TRADE_UPDATE" class="form-control" rows="3" style="font-size:0.8rem;"></textarea>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header"><button class="accordion-button collapsed py-2" type="button" data-bs-toggle="collapse" data-bs-target="#tg_c3">2. Trade Activated</button></h2>
                    <div id="tg_c3" class="accordion-collapse collapse" data-bs-parent="#tgAccordion">
                        <div class="accordion-body p-2">
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" id="tg_evt_TRADE_ACTIVATED">
                                <label class="form-check-label small">Send Alert</label>
                            </div>
                            <textarea id="tg_tmpl_TRADE_ACTIVATED" class="form-control" rows="3" style="font-size:0.8rem;"></textarea>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header"><button class="accordion-button collapsed py-2" type="button" data-bs-toggle="collapse" data-bs-target="#tg_c4">3-5. Target Hit</button></h2>
                    <div id="tg_c4" class="accordion-collapse collapse" data-bs-parent="#tgAccordion">
                        <div class="accordion-body p-2">
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" id="tg_evt_TARGET_HIT">
                                <label class="form-check-label small">Send Alert</label>
                            </div>
                            <textarea id="tg_tmpl_TARGET_HIT" class="form-control" rows="3" style="font-size:0.8rem;"></textarea>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header"><button class="accordion-button collapsed py-2" type="button" data-bs-toggle="collapse" data-bs-target="#tg_c5">6. Made High (Live)</button></h2>
                    <div id="tg_c5" class="accordion-collapse collapse" data-bs-parent="#tgAccordion">
                        <div class="accordion-body p-2">
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" id="tg_evt_MADE_HIGH">
                                <label class="form-check-label small">Send Alert</label>
                            </div>
                            <textarea id="tg_tmpl_MADE_HIGH" class="form-control" rows="3" style="font-size:0.8rem;"></textarea>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header"><button class="accordion-button collapsed py-2" type="button" data-bs-toggle="collapse" data-bs-target="#tg_c6">7. Close Summary (3:30/Exit)</button></h2>
                    <div id="tg_c6" class="accordion-collapse collapse" data-bs-parent="#tgAccordion">
                        <div class="accordion-body p-2">
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" id="tg_evt_CLOSE_SUMMARY">
                                <label class="form-check-label small">Send Alert</label>
                            </div>
                            <textarea id="tg_tmpl_CLOSE_SUMMARY" class="form-control" rows="3" style="font-size:0.8rem;"></textarea>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mt-3 text-muted small">
                <strong>Placeholders:</strong> {symbol}, {mode}, {type}, {entry}, {sl}, {targets}, {qty}, {ltp}, {pnl}, {high}
            </div>
        </div>
    </div> </div> <div class="modal-footer"><button type="button" class="btn btn-primary w-100" onclick="saveSettings()">Save Changes</button></div> </div> </div> </div>
