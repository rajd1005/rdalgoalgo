<div id="trade" class="dashboard-tab active">
    <form action="/trade" method="post" id="tradeForm">
        <div class="custom-card">
            <div class="card-head"><span>New Order</span> <span id="inst_ltp" class="badge bg-primary">LTP: 0</span></div>
            <div class="card-body">
                <div class="mb-3">
                    <div class="d-flex justify-content-between align-items-center mb-1">
                        <label class="pos-grid-label">WATCHLIST</label>
                        <div class="input-group input-group-sm" style="width: auto;">
                            <select id="trade_watch" class="form-select fw-bold border-secondary" onchange="loadWatchlist('trade_watch', '#sym')"><option value="">üì∫ Select</option></select>
                            <button class="btn btn-outline-danger" type="button" onclick="removeFromWatchlist('trade_watch')">üóëÔ∏è</button>
                        </div>
                    </div>
                    <div class="input-group">
                        <input type="text" id="sym" name="index" class="form-control fw-bold" placeholder="e.g. NIFTY" list="sym_list" required>
                        <button class="btn btn-outline-secondary" type="button" onclick="addToWatchlist('#sym')">‚ûï</button>
                    </div>
                    <datalist id="sym_list"></datalist>
                </div>

                <div class="mb-3">
                    <div class="btn-group w-100 btn-group-check" role="group">
                        <input type="radio" class="btn-check" name="type" id="t_ce" value="CE" autocomplete="off">
                        <label class="btn btn-outline-secondary" for="t_ce">CE</label>
                        <input type="radio" class="btn-check" name="type" id="t_pe" value="PE" autocomplete="off">
                        <label class="btn btn-outline-secondary" for="t_pe">PE</label>
                        <input type="radio" class="btn-check" name="type" id="t_fut" value="FUT" autocomplete="off">
                        <label class="btn btn-outline-secondary" for="t_fut">FUT</label>
                        <input type="radio" class="btn-check" name="type" id="t_eq" value="EQ" autocomplete="off">
                        <label class="btn btn-outline-secondary" for="t_eq">EQ</label>
                    </div>
                </div>

                <div class="row g-2 mb-3">
                    <div class="col-6"><select name="expiry" id="exp" class="form-select"></select></div>
                    <div class="col-6"><select name="strike" id="str" class="form-select"></select></div>
                </div>
                
                <div class="row g-2 mb-3">
                    <div class="col-6">
                        <label class="pos-grid-label">QTY (<span id="lot">1</span> x <span id="qty_mult_disp">1</span>)</label>
                        <div class="input-group">
                            <button class="btn btn-outline-secondary" type="button" onclick="adjQty('#qty', -1)">-</button>
                            <input type="number" name="qty" id="qty" class="form-control fw-bold text-center" value="1">
                            <button class="btn btn-outline-secondary" type="button" onclick="adjQty('#qty', 1)">+</button>
                        </div>
                    </div>
                    <div class="col-6"><label class="pos-grid-label">ORDER</label><select name="order_type" id="ord" class="form-select fw-bold"><option value="LIMIT">LIMIT</option><option value="MARKET">MARKET</option></select></div>
                </div>
                
                <div id="lim_box" class="mb-3">
                    <label class="pos-grid-label">LIMIT PRICE</label>
                    <input type="number" step="0.05" name="limit_price" id="lim_pr" class="form-control mb-3 text-primary fw-bold" placeholder="Limit Price">
                </div>
            </div>
        </div>

        <div class="custom-card">
            <div class="card-head">üõ°Ô∏è Projected P&L</div>
            <div class="card-body">
                <div class="row g-2 align-items-center mb-3">
                        <div class="col-6">
                            <label class="pos-grid-label">SL Points (Auto)</label>
                            <input type="number" id="sl_pts" name="sl_points" class="form-control fw-bold text-center" value="20" oninput="calcSLPriceFromPts('#sl_pts', '#p_sl')">
                        </div>
                        <div class="col-6">
                            <label class="pos-grid-label">SL Price (Edit)</label>
                            <input type="number" step="0.05" id="p_sl" class="form-control text-center text-danger fw-bold border-danger" oninput="calcSLPtsFromPrice('#p_sl', '#sl_pts')">
                        </div>
                </div>
                
                <div class="row g-2 text-center">
                    <div class="col-4 px-1">
                        <small class="text-success fw-bold">T1 (<span id="r_t1">0.5</span>x)</small>
                        <input type="number" step="0.05" id="p_t1" name="t1_price" class="form-control form-control-sm text-center text-success fw-bold mb-1" oninput="calcPnl('t1')">
                        <div class="input-group input-group-sm mb-1">
                            <div class="input-group-text px-1"><input class="form-check-input mt-0" type="checkbox" name="t1_active" checked></div>
                            <input type="number" name="t1_lots" class="form-control px-1 text-center" placeholder="Lots">
                        </div>
                        <span id="pnl_t1" class="pnl-green">‚Çπ 0</span>
                    </div>
                    <div class="col-4 px-1">
                        <small class="text-success fw-bold">T2 (<span id="r_t2">1.0</span>x)</small>
                        <input type="number" step="0.05" id="p_t2" name="t2_price" class="form-control form-control-sm text-center text-success fw-bold mb-1" oninput="calcPnl('t2')">
                        <div class="input-group input-group-sm mb-1">
                            <div class="input-group-text px-1"><input class="form-check-input mt-0" type="checkbox" name="t2_active" checked></div>
                            <input type="number" name="t2_lots" class="form-control px-1 text-center" placeholder="Lots">
                        </div>
                        <span id="pnl_t2" class="pnl-green">‚Çπ 0</span>
                    </div>
                    <div class="col-4 px-1">
                        <small class="text-success fw-bold">T3 (<span id="r_t3">1.5</span>x)</small>
                        <input type="number" step="0.05" id="p_t3" name="t3_price" class="form-control form-control-sm text-center text-success fw-bold mb-1" oninput="calcPnl('t3')">
                        <div class="input-group input-group-sm mb-1">
                            <div class="input-group-text px-1"><input class="form-check-input mt-0" type="checkbox" name="t3_active" checked></div>
                            <input type="number" name="t3_lots" class="form-control px-1 text-center" placeholder="Lots">
                        </div>
                        <span id="pnl_t3" class="pnl-green">‚Çπ 0</span>
                    </div>
                </div>
                <div class="text-center mt-2">
                    <small class="text-danger fw-bold">Est. Loss: </small><span id="pnl_sl" class="pnl-red" style="display:inline;">‚Çπ 0</span>
                </div>
            </div>
        </div>

        <input type="hidden" name="mode" id="mode_input" value="PAPER">
        <div class="d-flex gap-2 mb-3">
            <div class="btn btn-outline-warning w-50 fw-bold active" onclick="setMode(this, 'PAPER')">PAPER</div>
            <div class="btn btn-outline-danger w-50 fw-bold" onclick="setMode(this, 'LIVE')">LIVE</div>
        </div>
        
        <div class="sticky-footer">
            <button type="submit" form="tradeForm" class="btn btn-dark w-100 py-2 fw-bold rounded-pill shadow-lg" style="max-width: 600px;">üöÄ EXECUTE</button>
        </div>
    </form>
</div>
